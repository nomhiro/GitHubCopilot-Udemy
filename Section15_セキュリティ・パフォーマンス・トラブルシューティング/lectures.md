# セキュリティ・パフォーマンス・トラブルシューティング

---

## レクチャー1: セキュリティ脆弱性の特定支援
**時間目安: 10分**

（内容を記述）

---

## レクチャー2: パフォーマンス最適化の提案活用
**時間目安: 10分**

（内容を記述）

---

## レクチャー3: Copilot Enterpriseでの協調コードレビュー
**時間目安: 12分**

（内容を記述）

---

## レクチャー4: コード提案が表示されない場合のトラブルシューティング
**時間目安: 10分**

### 学習目標
- GitHub Copilotでコードの提案が表示されない原因を特定できる
- 各問題に対する適切なトラブルシューティング手順を実行できる
- コンテンツ除外が提案に与える影響を理解する

### 内容

GitHub Copilotでユーザーが遭遇する最も一般的な問題の1つは、コードの提案が表示されないことです。以下のトラブルシューティング手順を順番に確認してください。

#### 1. インターネット接続を確認する

GitHub Copilotが正常に機能するには、**アクティブなインターネット接続が必要**です。

| チェック項目 | 確認方法 |
|-------------|---------|
| ネットワーク接続 | ブラウザでWebサイトにアクセスできるか確認 |
| 接続の安定性 | 断続的な接続ではなく、安定した接続であることを確認 |
| VPN/プロキシ | 企業ネットワークの場合、VPNやプロキシが正しく設定されているか確認 |

#### 2. Copilot拡張機能を更新する

最新バージョンのGitHub Copilot拡張機能を使用していることを確認します。

##### 更新手順（VS Code）
1. 拡張機能サイドバーを開く（`Ctrl+Shift+X`）
2. 「GitHub Copilot」を検索
3. 更新が利用可能な場合は「更新」ボタンをクリック
4. IDEを再起動

**注意**: 古いバージョンでは、Copilotサーバーと効果的に通信できない場合があります。

#### 3. IDEの互換性を確認する

IDEがGitHub Copilotと互換性があることを確認します。

| IDE | 対応状況 |
|-----|---------|
| Visual Studio Code | ✅ 完全対応 |
| Visual Studio | ✅ 対応（要設定） |
| JetBrains IDEs | ✅ 対応（IntelliJ, PyCharm等） |
| Vim/Neovim | ✅ 対応（要プラグイン） |

IDEによっては、Copilotを使うために**特定の構成や更新**が必要な場合があります。

#### 4. コンテンツの除外を確認する

特定のファイルがCopilotの分析から除外されている場合、それらのファイルに関する提案が表示されない可能性があります。

##### 確認方法
1. ステータスバーのGitHub Copilotアイコンを確認
2. アイコンに斜線が表示されている場合 → コンテンツ除外が適用されている
3. アイコンをホバーして、どのレベル（組織/リポジトリ）で無効になっているか確認

##### コンテンツ除外の設定確認場所
- **リポジトリレベル**: リポジトリ設定 → Code & automation → Copilot
- **組織レベル**: 組織設定 → Copilot → Content exclusion

#### トラブルシューティングフローチャート

```
提案が表示されない
    ↓
① インターネット接続OK? → NO → ネットワーク問題を解決
    ↓ YES
② 拡張機能は最新? → NO → 拡張機能を更新
    ↓ YES
③ IDEは対応済み? → NO → 対応IDEに移行
    ↓ YES
④ コンテンツ除外されている? → YES → 除外設定を確認
    ↓ NO
⑤ GitHubサポートに問い合わせ
```

**参照**: [GitHub Copilot に関する一般的な問題のトラブルシューティング - Microsoft Learn](https://learn.microsoft.com/ja-jp/training/modules/github-copilot-management-and-customizations/5-troubleshoot-common-issues-with-github-copilot)

---

## レクチャー5: コンテキスト除外が適用されない場合の対処
**時間目安: 8分**

### 学習目標
- コンテンツ除外が想定どおりに機能しない一般的なシナリオを理解する
- 各問題に対する適切な対処方法を実行できる
- IDE固有の制限事項を把握する

### 内容

コンテンツの除外は、GitHub Copilotが特定のファイルまたはディレクトリを使用できないように設計されています。しかし、一部のシナリオでは、コンテンツの除外が想定どおりに機能しない場合があります。

#### 1. 除外の適用の遅れ

コンテンツ除外を追加または変更した後、設定が既に読み込まれているIDE上でその変更が有効になるまでに**最大で30分**かかることがあります。

##### 対処方法

| 方法 | 手順 |
|------|------|
| **IDE再起動** | 変更をすぐに適用するには、IDEを再起動してコンテンツ除外設定を再読み込み |
| **拡張機能再読み込み** | VS Codeの場合、コマンドパレットから「Developer: Reload Window」を実行 |
| **待機** | 緊急でない場合は、最大30分待つ |

#### 2. 除外の範囲が不適切

コンテンツ除外が適用されない場合、設定の範囲が正しくない可能性があります。

##### 確認ポイント

1. **組織メンバーシップの確認**
   - コンテンツ除外の設定は、**除外が構成されている組織のメンバーにのみ適用**されます
   - 関連するすべてのチームメンバーに適切な設定が適用されていることを確認

2. **ステータスバーの確認**
   - GitHub Copilotアイコンを確認
   - コンテンツ除外がファイルに適用される場合は、アイコンに**斜線**が表示される
   - アイコンをポイントして、そのファイルに対するGitHub Copilotが組織または親リポジトリで無効になっているかどうかを確認

##### 除外が適用されない例

| シナリオ | 理由 |
|---------|------|
| 組織外のユーザーがフォークしたリポジトリを使用 | 除外設定は元の組織メンバーにのみ適用 |
| パブリックリポジトリの外部コントリビューター | 組織のポリシーが適用されない |

#### 3. IDE固有の制限

IDEによっては、特定の機能を使っているとコンテンツの除外が適用されない場合があります。

##### Visual Studio Code と Visual Studio での制限

| 状況 | 制限事項 |
|------|---------|
| `@github` チャット参加者を使用 | コンテンツの除外が適用されない |
| GitHub Copilot Chat の特定機能 | 一部の機能で除外が適用されない場合がある |

**重要**: `@github` を使用する際は、除外対象のコンテンツが応答に含まれる可能性があることを認識しておく必要があります。

##### セマンティック情報の制限

IDEによってセマンティック情報が除外されていないファイルで提供される場合、Copilotは除外されたファイルからの情報も使う場合があります。

**セマンティック情報に含まれるもの:**
- コードで使われるシンボルの**型情報**
- 関数呼び出しの**ホバーオーバー定義**

```
【例】
- secrets/config.ts を除外設定している
- main.ts で secrets/config.ts からインポートした関数を使用
- main.ts で作業中、IDEがその関数の型情報を提供
  → Copilotは除外されたファイルからの情報を使用する可能性がある
```

#### まとめ：コンテンツ除外のトラブルシューティングチェックリスト

| チェック項目 | 対処方法 |
|-------------|---------|
| 設定変更後すぐに反映されない | IDEを再起動または最大30分待機 |
| 特定のユーザーに除外が適用されない | 組織メンバーシップを確認 |
| `@github` 使用時に除外コンテンツが含まれる | IDE固有の制限として認識し、別の方法を検討 |
| 型情報を通じて除外コンテンツが使用される | セマンティック情報の制限として認識 |

**参照**: [GitHub Copilot に関する一般的な問題のトラブルシューティング - Microsoft Learn](https://learn.microsoft.com/ja-jp/training/modules/github-copilot-management-and-customizations/5-troubleshoot-common-issues-with-github-copilot)

---

## レクチャー6: 提案がない場合のCopilotトリガー方法
**時間目安: 8分**

### 学習目標
- GitHub Copilotの提案品質を向上させるテクニックを理解する
- 手動でCopilotをトリガーする方法を習得する
- 効果的なプロンプト作成の基本を理解する

### 内容

GitHub Copilotが生成している提案が不十分な場合、以下の手法を使用することでCopilotにより良い結果を提供するように促すことができます。

#### 1. 明確なコンテキストを提供する

関連する提案を生成するための明確なコンテキストを、コードでGitHub Copilotに提供するようにします。

##### 効果的なコンテキスト提供の方法

| 方法 | 説明 | 例 |
|------|------|-----|
| **わかりやすいコメント** | 実行したい処理を自然言語で記述 | `// ユーザーの年齢を検証し、18歳以上かチェックする` |
| **意味のある変数名** | 変数の目的が明確な名前を使用 | `userAge` vs `x` |
| **関数名の工夫** | 関数の動作を明確に示す名前 | `validateUserAge()` vs `check()` |
| **型アノテーション** | 期待するデータ型を明示 | `function calculate(price: number): number` |

##### 良い例と悪い例

```python
# ❌ 悪い例：コンテキストが不明確
def f(x):
    pass

# ✅ 良い例：コンテキストが明確
def calculate_total_price(items: list, tax_rate: float) -> float:
    """
    商品リストの合計金額を計算し、税込み価格を返す
    """
    pass
```

#### 2. Copilotコマンドを使う

一部のIDEでは、特定のコマンドを使ってCopilotに提案を生成するようプロンプトできます。

##### Visual Studio Code でのトリガー方法

| 操作 | ショートカット | 説明 |
|------|---------------|------|
| **手動トリガー** | `Ctrl + Enter` | Copilotに提案を生成させる |
| **複数の提案を表示** | `Ctrl + Enter` | 別ウィンドウで複数の提案を表示 |
| **次の提案** | `Alt + ]` | 次の提案候補を表示 |
| **前の提案** | `Alt + [` | 前の提案候補を表示 |
| **インラインチャット** | `Ctrl + I` | インラインでCopilotに質問 |

##### コマンドパレットからの操作
1. `Ctrl + Shift + P` でコマンドパレットを開く
2. 「Copilot」と入力
3. 使用したいコマンドを選択

#### 3. プロンプトの長さを調整する

場合によっては、指定するプロンプトをさらに長く、または詳細にすると、Copilotがより良い提案を生成するのに役立ちます。

##### プロンプト調整のテクニック

| テクニック | 説明 |
|-----------|------|
| **詳細なコメント** | 処理の目的、入力、出力を明確に記述 |
| **段階的なアプローチ** | 複雑な処理を小さなステップに分割 |
| **例示** | 期待する入出力の例を提供 |
| **制約の明示** | エッジケースや制約条件を明記 |

##### プロンプト調整の例

```javascript
// ❌ 短すぎるプロンプト
// 配列をソート

// ✅ 詳細なプロンプト
// 配列内のオブジェクトを price プロパティで昇順にソートする
// 入力: [{name: "A", price: 100}, {name: "B", price: 50}]
// 出力: [{name: "B", price: 50}, {name: "A", price: 100}]
function sortByPrice(items) {
```

#### 提案品質向上のベストプラクティス

| プラクティス | 効果 |
|-------------|------|
| 開いているファイルを整理 | 関連するファイルのみを開いてコンテキストを絞る |
| 適切なファイル拡張子を使用 | 言語を正しく認識させる |
| コードの構造を維持 | 一貫したコーディングスタイルを保つ |
| フィードバックを活用 | 提案を受け入れ/拒否してCopilotの学習を促進 |

#### まとめ

提案の品質を向上させるための3つの主要な手法：

1. **明確なコンテキスト**: わかりやすいコメントと変数名で意図を伝える
2. **Copilotコマンド**: ショートカットを使って手動で提案を要求
3. **プロンプト調整**: 詳細な説明で期待する結果を明確にする

**参照**: [GitHub Copilot に関する一般的な問題のトラブルシューティング - Microsoft Learn](https://learn.microsoft.com/ja-jp/training/modules/github-copilot-management-and-customizations/5-troubleshoot-common-issues-with-github-copilot)

---

## 確認テスト: セキュリティ・パフォーマンス・トラブルシューティング

### 問題1
GitHub Copilotでコードの提案が表示されない場合、最初に確認すべきことは何ですか？

- A) IDEを再インストールする
- B) インターネット接続を確認する ✓
- C) GitHubアカウントを削除する
- D) コンピュータを再起動する

---

### 問題2
コンテンツ除外の設定変更後、IDEで変更が有効になるまでに最大で何分かかることがありますか？

- A) 5分
- B) 15分
- C) 30分 ✓
- D) 60分

---

### 問題3
コンテンツ除外が適用されているかどうかを確認するには、IDEのどこを見ればよいですか？

- A) ファイルエクスプローラー
- B) ステータスバーのGitHub Copilotアイコン ✓
- C) ターミナル
- D) 拡張機能の設定

---

### 問題4
GitHub Copilotの提案の品質を向上させるための方法として**正しくない**ものはどれですか？

- A) 明確なコメントを記述する
- B) わかりやすい変数名を使用する
- C) プロンプトを短くシンプルにする ✓
- D) 関連するコンテキストを提供する

---

### 問題5
Visual Studio Codeで手動でGitHub Copilotをトリガーするショートカットキーは何ですか？

- A) Ctrl + Space
- B) Ctrl + Enter ✓
- C) Ctrl + Shift + P
- D) Alt + Tab

---

### 問題6
コンテンツ除外の設定が適用されるのは誰ですか？

- A) GitHubの全ユーザー
- B) リポジトリにアクセスできる全ユーザー
- C) 除外が構成されている組織のメンバーのみ ✓
- D) Copilot Individual プランのユーザーのみ

---

### 問題7
IDE固有の制限として、GitHub Copilot Chatでコンテンツ除外が適用されない場合があるのはどのような状況ですか？

- A) インラインチャットを使用している場合
- B) スラッシュコマンドを使用している場合
- C) `@github` チャット参加者を使用している場合 ✓
- D) 複数のファイルを同時に開いている場合

---

### 問題8
GitHub Copilotの提案が不十分な場合の改善策として最も効果的なものはどれですか？

- A) Copilotを再インストールする
- B) 別のプログラミング言語を使用する
- C) 明確なコンテキストとわかりやすい変数名を提供する ✓
- D) インターネット接続を高速化する

---

### 問題9
GitHub Copilot からのコードの提案が提供されない場合はどうすべきですか?

- A) コンピューターを再起動する
- B) インターネット接続を確認する ✓
- C) Copilot 拡張機能を無効にする
- D) プログラミング言語を変更する

---

### 追加問題: セキュリティ認定試験対策（類似問題）

### 問題10
ソフトウェア開発における「コード品質」の主要な要素として**含まれない**ものはどれですか？

- A) 可読性（Readability）
- B) 保守性（Maintainability）
- C) 開発者の勤務時間
- D) 信頼性（Reliability）

> **解説**: コード品質の主要な要素には、可読性、保守性、信頼性、テスト可能性、パフォーマンスなどが含まれます。開発者の勤務時間はコード品質の要素ではありません。✓は C)

---

### 問題11
コードの「信頼性」を向上させるための方法として最も適切なものはどれですか？

- A) コードのコメントをすべて削除する
- B) 適切なエラーハンドリング、入力検証、エッジケースのテストを実装する ✓
- C) コードをできるだけ短くする
- D) 外部ライブラリをすべて削除する

> **解説**: コードの信頼性を向上させるには、適切なエラーハンドリング、入力検証、エッジケースを含む包括的なテスト、そして予期しない状況への対応が重要です。

---

### 問題12
GitHub Copilotを使用して高品質なコードを維持するためのベストプラクティスとして正しいものはどれですか？

- A) 生成されたコードをそのまま使用し、レビューしない
- B) 生成されたコードを常にレビューし、セキュリティとパフォーマンスを確認する ✓
- C) 生成されたコードを完全に無視する
- D) 生成されたコードを別のファイルに保存する

> **解説**: GitHub Copilotが生成したコードは、常に開発者がレビューする必要があります。セキュリティ脆弱性、パフォーマンスの問題、ベストプラクティスへの準拠を確認することが重要です。

---

### 問題13
例外処理の改善についてGitHub Copilotに支援を求める場合の効果的なアプローチはどれですか？

- A) 「エラーを修正して」と曖昧に依頼する
- B) 具体的なエラーシナリオと期待する処理方法を明確に指定する ✓
- C) 例外処理をすべて削除するよう依頼する
- D) エラーメッセージを無視するよう依頼する

> **解説**: GitHub Copilotに例外処理の改善を依頼する際は、具体的なエラーシナリオ（null値、範囲外のインデックス、ネットワークエラーなど）と期待する処理方法を明確に指定することで、より適切な提案を得ることができます。

---

### 問題14
GitHub Copilotが生成したコードのセキュリティを確保するための推奨事項として正しいものはどれですか？

- A) すべての生成コードは自動的にセキュアなので確認不要
- B) XSS、SQLインジェクション、入力検証などのセキュリティ脆弱性を手動で確認する ✓
- C) セキュリティチェックはCopilot Enterpriseでのみ必要
- D) セキュリティは外部ツールでのみ確認可能

> **解説**: GitHub Copilotが生成したコードには、クロスサイトスクリプティング（XSS）、SQLインジェクション、不適切な入力検証などのセキュリティ脆弱性が含まれる可能性があります。生成されたコードは常に手動でセキュリティを確認する必要があります。
