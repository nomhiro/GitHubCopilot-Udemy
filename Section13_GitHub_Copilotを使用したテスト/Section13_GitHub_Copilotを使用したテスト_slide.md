---
marp: true
theme: custom-theme
paginate: true
---

<!-- _class: title -->
<!-- _paginate: false -->

# GitHub Copilotを使用したテスト

---

# このセクションで学ぶこと

## 学習目標

- GitHub Copilotによるテスト生成の5つのタスクを理解する
- 単体テストを生成する4つの方法（チャットビュー、インラインチャット、スマートアクション、コード補完）を習得する
- エッジケースの特定とテスト提案の活用方法を学ぶ
- 失敗したテストの修正とアサーション作成の支援を理解する

---

<!-- _class: lecture -->
<!-- _paginate: false -->

# テスト生成の概要

---

# GitHub Copilot Chatによる単体テストの提案

## 主な機能

- メソッドのシグネチャと本文から、入力パラメーターと期待される出力値をカバーするテストケースを提案
- 既存のテストケースがある場合、追加のテストケース用のコード補完候補を生成
- コード行補完を使用して単体テストを生成し、反復的なプロセスを削減

---

# Copilotがテストで支援できる5つのタスク

| タスク | 説明 |
|-------|------|
| **テストフレームワークを設定する** | プロジェクトと言語に適したフレームワークとVS Code拡張機能の構成 |
| **テストコードを生成する** | 単体テスト、統合テスト、E2Eテストの作成 |
| **エッジケースの処理** | エッジケースとエラー状態をカバーする包括的なテストスイートを生成 |
| **失敗したテストを修正する** | テストの失敗を修正するための提案を受け取る |
| **一貫性を維持する** | プロジェクトのコーディングプラクティスに従うテストを生成 |

---

# 重要な注意事項

## 生成されたテストの限界

> **重要**: 生成されたテストケースは、考えられるすべてのシナリオをカバーしているとは限りません。
> コードの品質を確保するには、**手動テストとコードレビュー**が必要です。

<span class="red">注意: Copilot生成のテストを追加の手動テストで補完すること</span>

---

<!-- _class: lecture -->
<!-- _paginate: false -->

# ユニットテストの自動生成

---

# テストフレームワークのセットアップ

## /setupTestsコマンド

テストワークフローを高速化するために、Copilotはプロジェクトのテストフレームワークとvs Code拡張機能を設定するのに役立ちます。

**セットアップ手順:**

1. チャットビューを開く
2. <span class="red">チャット入力フィールドに `/setupTests` コマンドを入力</span>
3. GitHub Copilotのガイダンスに従ってプロジェクトを構成

---

# 単体テストを生成する4つの方法

| 方法 | 説明 |
|------|------|
| **チャットビュー** | Ask、Edit、Agentモードでプロジェクト・クラス・メソッドのテストを生成 |
| **インラインチャット** | コードエディターで直接テストを作成（Ctrl+I） |
| **スマートアクション** | 右クリック→Copilot→テストの生成 でプロンプト不要 |
| **コード行の入力候補** | 既存のテストケースに対する追加テストを提案 |

---

# チャットビューの3つのモード

| モード | 最適化されている用途 |
|--------|---------------------|
| **Ask** | コードプロジェクト、コーディングトピック、一般的なテクノロジの概念に関する質問 |
| **Edit（編集）** | コードベース内の複数のファイル間で編集を行う |
| **Agent（エージェント）** | エージェントコーディングワークフローを開始する |

<span class="red">注意: エージェントモードでは1つのタスクで複数のPremium要求が行われる場合があります</span>

---

# Askモードを使用して単体テストを作成

## 手順

| ステップ | 操作 |
|---------|------|
| 1 | テストするコードを含むファイルを開く |
| 2 | チャットビューでAskモードを使用して新しいチャットセッションを開始 |
| 3 | チャットセッションにコンテキストを追加 |
| 4 | ファイル内のコードの単体テストを求めるプロンプトを入力 |
| 5 | 推奨される単体テストを確認し、テストファイルに移動 |

---

# Askモード: コンテキストの追加方法

## コンテキストの追加方法

- エクスプローラービューからチャットビューにファイルを**ドラッグ＆ドロップ**
- **[コンテキストの追加]** ボタンを使用
- `@workspace` チャット変数を使用してワークスペースを指定

## プロンプト例

```
@workspace /explain I need to create unit tests for the code
in this file. The tests should be written in Python and use
the unittest framework.
```

---

# 編集モードを使用して単体テストを作成

## 編集モードの特徴

- ファイル内の特定の関数またはメソッドのテストを作成する場合に便利
- コードベース内の複数のファイル間で編集を行う場合に最適

## 重要な制限事項

<span class="red">注意: 編集モードではチャット参加者が使用できないため、`@workspace` は指定できません</span>

代わりに以下を使用:
- `#codebase` を使用
- エクスプローラービューからファイルをドラッグ＆ドロップ

---

# エージェントモードを使用して単体テストを作成

## エージェントモードの特徴

- コンテキストを指定する必要がない（Copilotが**自動的に決定**）
- 編集する関連するコンテキストとファイルを自動的に検出
- **テストエクスプローラー**ツールでテストを実行
- **ターミナル**ツールでコマンドを実行
- 実行中のタスクを中断してコンテキストやツールを変更可能

<span class="red">試験ポイント: エージェントモードは「プロジェクトをより深く理解する必要がある単体テストの作成」に最適</span>

---

# インラインチャットで単体テストを作成

## インラインチャットの利点

- チャットビューに切り替えずに特定の関数やメソッドのテストを作成
- スマートアクションよりも細かい制御が可能

## 使用方法

| ステップ | 操作 |
|---------|------|
| 1 | テストするコードを選択 |
| 2 | **Ctrl + I** でインラインチャットを開く |
| 3 | プロンプトを入力（例: `/tests このメソッドの単体テストを生成`） |
| 4 | 生成されたテストを確認し、[承諾] または [閉じる] を選択 |

---

# 「テストの生成」スマートアクション

## アクセス方法

1. テストするコードを含むファイルを開く
2. コードエディター内を右クリック
3. **[Copilot]** を選択
4. **[テストの生成]** を選択

## 特徴

- プロンプトを記述せずに選択したコードの単体テストを生成
- ファイル全体または選択範囲のみを対象にできる
- 各関数またはメソッドのさまざまなシナリオに対応するアサーションが含まれる

---

<!-- _class: lecture -->
<!-- _paginate: false -->

# エッジケースの特定とテスト提案

---

# エッジケースと境界条件のテスト

## Copilotが提案できるエッジケース

| 種類 | 説明 |
|------|------|
| エラー処理のテストケース | 例外やエラー状態の処理を検証 |
| null値のテストケース | null入力の適切な処理を確認 |
| 予期しない入力の型のテストケース | 型の不一致に対する堅牢性を検証 |

---

# 単一メソッド vs 複数メソッドの選択

## プロンプトの使い分け

| シナリオ | 推奨プロンプト |
|---------|--------------|
| 単一メソッドがエディターで完全に表示されている場合 | `Write a unit test for the method in the #editor` |
| 複数のメソッドが表示されている場合 | コードを選択して `#selection write a unit test for this code` |

## エッジケースを含むテストのプロンプト例

```
Generate unit tests for this method, including edge cases
for null values, empty strings, and boundary conditions
```

---

<!-- _class: lecture -->
<!-- _paginate: false -->

# 失敗したテストの修正とテストフレームワーク

---

# 失敗したテストの修正

## 方法1: テストエクスプローラーから修正

1. テストエクスプローラーで、失敗したテストにカーソルを合わせる
2. **[テストエラーの修正]** ボタン（スパークルアイコン）を選択
3. Copilotの推奨される修正プログラムを確認して適用

## 方法2: スラッシュコマンドで修正

1. チャットビューを開く
2. <span class="red">`/fixTestFailure` スラッシュコマンドを入力</span>
3. Copilotの提案に従ってテストを修正

---

# エージェントモードでの自動修正

## 自動修正機能

<span class="red">エージェントモードでは、テストの実行時にテスト出力が監視され、**失敗したテストの修正と再実行が自動的に試行**されます。</span>

## メリット

- テスト失敗の検出から修正までを自動化
- 修正後の再実行で結果を即座に確認
- 手動介入を最小限に抑える

---

# C#開発キットがサポートするテストフレームワーク

| フレームワーク | コマンドパレットでの選択 | パッケージ参照 |
|--------------|----------------------|--------------|
| **xUnit** | .NET: 新しいプロジェクト... → xUnit テスト プロジェクト | `xUnit`, `xunit.runner.visualstudio` |
| **NUnit** | .NET: 新しいプロジェクト... → NUnit3 テスト プロジェクト | `NUnit`, `NUnit3TestAdapter` |
| **MSTest** | .NET: 新しいプロジェクト... → MSTest テスト プロジェクト | `MSTest.TestAdapter`, `MSTest.TestFramework` |

<span class="red">注意: JUnitはJava用のフレームワークであり、C#開発キットではサポートされていません</span>

# まとめ

## このセクションで学んだこと

| トピック | 内容 |
|----------|------|
| テスト生成の概要 | Copilotがテストで支援できる5つのタスク |
| 4つのテスト生成方法 | チャットビュー、インラインチャット、スマートアクション、コード補完 |
| チャットビューの3モード | Ask、Edit、Agentモードの使い分け |
| エッジケース | null値、エラー処理、予期しない入力の型のテスト |
| 失敗したテストの修正 | `/fixTestFailure` コマンドとエージェントモードでの自動修正 |
| テストフレームワーク | xUnit、NUnit、MSTest（C#開発キット） |

---

# 試験対策ポイント

## 覚えておくべきコマンドとショートカット

| 操作 | コマンド/ショートカット |
|------|----------------------|
| テストフレームワーク設定 | `/setupTests` |
| 失敗したテストの修正 | `/fixTestFailure` |
| インラインチャットを開く | `Ctrl + I` |
| テストの生成（スマートアクション） | 右クリック → Copilot → テストの生成 |

---

# よくある誤答パターン

## 試験で間違えやすいポイント

| 正しい | 誤り |
|--------|------|
| Copilot生成テストは手動テストで補完が必要 | Copilotテストは100%カバレッジを保証する |
| 編集モードでは`@workspace`が使用できない | 編集モードでも`@workspace`が使用できる |
| パフォーマンステストはエッジケースに含まれない | Copilotはパフォーマンステストを自動生成する |
| JUnitはC#開発キットでサポートされない | JUnitはC#開発キットでサポートされる |
| エージェントモードは複数のPremium要求を使用 | エージェントモードは1回のPremium要求のみ |

---

<!-- _class: title -->
<!-- _paginate: false -->

# GitHub Copilotを使用したテスト
## セクション完了
